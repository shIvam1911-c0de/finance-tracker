import{r as l,u as f,e as N,c as o,j as e}from"./index-DeXpUch5.js";const w=()=>{const[m,g]=l.useState([]),[x,c]=l.useState([]),[h,b]=l.useState(!0),[y,i]=l.useState(!1),{canModify:u}=f(),{isDark:a}=N(),[r,n]=l.useState({category:"",amount:"",period:"monthly",currency:"USD",start_date:new Date().toISOString().split("T")[0],end_date:""}),d=l.useCallback(async()=>{try{const t=await o.get("/budgets");g(t.data);try{const s=await o.get("/budgets/alerts");c(s.data)}catch(s){console.warn("Budget alerts not available:",s.message),c([])}}catch(t){console.error("Failed to fetch budgets:",t),g([]),c([])}finally{b(!1)}},[]);l.useEffect(()=>{d()},[d]);const p=async t=>{t.preventDefault();try{await o.post("/budgets",r),i(!1),n({category:"",amount:"",period:"monthly",currency:"USD",start_date:new Date().toISOString().split("T")[0],end_date:""}),d()}catch(s){console.error("Failed to create budget:",s)}},j=async t=>{if(window.confirm("Delete this budget?"))try{await o.delete(`/budgets/${t}`),d()}catch(s){console.error("Failed to delete budget:",s)}};return h?e.jsx("div",{children:"Loading budgets..."}):e.jsxs("div",{className:`p-6 ${a?"bg-gray-900 text-white":"bg-white text-gray-900"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:`text-3xl font-bold ${a?"text-white":"text-gray-900"}`,children:"Budget Management"}),u()&&e.jsx("button",{onClick:()=>i(!0),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg",children:"Add Budget"})]}),x.length>0&&e.jsxs("div",{className:`mb-6 ${a?"bg-orange-900/20 border-orange-700":"bg-orange-50 border-orange-200"} border rounded-lg p-4`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-2 ${a?"text-orange-300":"text-orange-800"}`,children:"Budget Alerts"}),x.map((t,s)=>e.jsxs("div",{className:a?"text-orange-200":"text-orange-700",children:[t.category,": ",Number(t.usage_percentage||0).toFixed(1),"% used ($",t.spent," / $",t.budget_amount,")"]},s))]}),e.jsx("div",{className:"grid gap-4",children:m.map(t=>e.jsx("div",{className:`${a?"bg-gray-800":"bg-white"} rounded-lg shadow p-4`,children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`text-lg font-semibold ${a?"text-white":"text-gray-900"}`,children:t.category}),e.jsxs("p",{className:a?"text-gray-300":"text-gray-600",children:[t.period," â€¢ ",t.currency]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Spent: $",t.spent||0]}),e.jsxs("span",{children:["Budget: $",t.amount]})]}),e.jsx("div",{className:`w-full ${a?"bg-gray-600":"bg-gray-200"} rounded-full h-2 mt-1`,children:e.jsx("div",{className:`h-2 rounded-full ${Number(t.usage_percentage||0)>100?"bg-red-500":Number(t.usage_percentage||0)>80?"bg-orange-500":"bg-green-500"}`,style:{width:`${Math.min(Number(t.usage_percentage||0),100)}%`}})}),e.jsxs("p",{className:`text-xs mt-1 ${a?"text-gray-400":"text-gray-500"}`,children:[Number(t.usage_percentage||0).toFixed(1),"% used"]})]})]}),u()&&e.jsx("button",{onClick:()=>j(t.id),className:"text-red-600 hover:text-red-800",children:"Delete"})]})},t.id))}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:`${a?"bg-gray-800":"bg-white"} rounded-lg p-6 w-96`,children:[e.jsx("h2",{className:`text-xl font-bold mb-4 ${a?"text-white":"text-gray-900"}`,children:"Add Budget"}),e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${a?"text-gray-300":"text-gray-700"}`,children:"Category"}),e.jsx("input",{type:"text",value:r.category,onChange:t=>n({...r,category:t.target.value}),className:`w-full border rounded px-3 py-2 ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${a?"text-gray-300":"text-gray-700"}`,children:"Amount"}),e.jsx("input",{type:"number",step:"0.01",value:r.amount,onChange:t=>n({...r,amount:t.target.value}),className:`w-full border rounded px-3 py-2 ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${a?"text-gray-300":"text-gray-700"}`,children:"Period"}),e.jsxs("select",{value:r.period,onChange:t=>n({...r,period:t.target.value}),className:`w-full border rounded px-3 py-2 ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded",children:"Create"}),e.jsx("button",{type:"button",onClick:()=>i(!1),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded",children:"Cancel"})]})]})]})})]})},$=()=>e.jsx(w,{});export{$ as default};
