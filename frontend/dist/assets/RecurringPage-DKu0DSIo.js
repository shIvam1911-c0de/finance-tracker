import{r as n,u as w,e as N,c as i,j as e}from"./index-DeXpUch5.js";import{f as $,C as S}from"./CurrencySelector-BUTVcRwZ.js";const y=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}],C=()=>{const[g,o]=n.useState([]),[m,d]=n.useState([]),[h,b]=n.useState(!0),[p,x]=n.useState(!1),{canModify:u}=w(),{isDark:r}=N(),[a,s]=n.useState({account_id:"",type:"expense",category:"",amount:"",currency:"USD",description:"",frequency:"monthly",start_date:new Date().toISOString().split("T")[0],end_date:""}),c=n.useCallback(async()=>{try{try{const t=await i.get("/accounts");d(t.data)}catch(t){console.warn("Accounts not available:",t.message),d([])}try{const t=await i.get("/recurring");o(t.data)}catch(t){console.warn("Recurring transactions not available:",t.message),o([])}}catch(t){console.error("Failed to fetch data:",t),o([]),d([])}finally{b(!1)}},[]);n.useEffect(()=>{c()},[c]);const j=async t=>{t.preventDefault();try{await i.post("/recurring",a),x(!1),s({account_id:"",type:"expense",category:"",amount:"",currency:"USD",description:"",frequency:"monthly",start_date:new Date().toISOString().split("T")[0],end_date:""}),c()}catch(l){console.error("Failed to create recurring transaction:",l)}},v=async t=>{if(window.confirm("Delete this recurring transaction?"))try{await i.delete(`/recurring/${t}`),c()}catch(l){console.error("Failed to delete recurring transaction:",l)}},f=t=>y.find(l=>l.value===t)?.label||t;return h?e.jsx("div",{className:r?"text-white":"text-gray-900",children:"Loading recurring transactions..."}):e.jsxs("div",{className:`p-6 ${r?"bg-gray-900 text-white":"bg-white text-gray-900"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:`text-3xl font-bold ${r?"text-white":"text-gray-900"}`,children:"ðŸ”„ Recurring Transactions"}),u()&&e.jsx("button",{onClick:()=>x(!0),className:"bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg",children:"Add Recurring"})]}),e.jsx("div",{className:"grid gap-4",children:g.map(t=>e.jsx("div",{className:`${r?"bg-gray-800":"bg-white"} rounded-lg shadow p-4`,children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.type==="income"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.type}),e.jsx("h3",{className:`text-lg font-semibold ${r?"text-white":"text-gray-900"}`,children:t.category})]}),e.jsx("p",{className:`mb-2 ${r?"text-gray-300":"text-gray-600"}`,children:t.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:r?"text-gray-400":"text-gray-500",children:"Amount:"}),e.jsx("span",{className:`ml-2 font-medium ${r?"text-white":"text-gray-900"}`,children:$(t.amount,t.currency)})]}),e.jsxs("div",{children:[e.jsx("span",{className:r?"text-gray-400":"text-gray-500",children:"Frequency:"}),e.jsx("span",{className:`ml-2 font-medium ${r?"text-white":"text-gray-900"}`,children:f(t.frequency)})]}),e.jsxs("div",{children:[e.jsx("span",{className:r?"text-gray-400":"text-gray-500",children:"Account:"}),e.jsx("span",{className:`ml-2 font-medium ${r?"text-white":"text-gray-900"}`,children:t.account_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:r?"text-gray-400":"text-gray-500",children:"Next:"}),e.jsx("span",{className:`ml-2 font-medium ${r?"text-white":"text-gray-900"}`,children:new Date(t.next_execution).toLocaleDateString()})]})]})]}),u()&&e.jsx("button",{onClick:()=>v(t.id),className:"text-red-600 hover:text-red-800 ml-4",children:"Delete"})]})},t.id))}),g.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:`text-lg ${r?"text-gray-400":"text-gray-500"}`,children:"No recurring transactions"}),e.jsx("p",{className:r?"text-gray-500":"text-gray-400",children:"Set up automatic income or expenses"})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:`${r?"bg-gray-800":"bg-white"} rounded-lg p-6 w-96 max-h-[90vh] overflow-y-auto`,children:[e.jsx("h2",{className:`text-xl font-bold mb-4 ${r?"text-white":"text-gray-900"}`,children:"Add Recurring Transaction"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-gray-300":"text-gray-700"}`,children:"Account"}),e.jsxs("select",{value:a.account_id,onChange:t=>s({...a,account_id:t.target.value}),className:`w-full border rounded px-3 py-2 ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,children:[e.jsx("option",{value:"",children:"Select Account"}),m.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.currency,")"]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-gray-300":"text-gray-700"}`,children:"Type"}),e.jsxs("select",{value:a.type,onChange:t=>s({...a,type:t.target.value}),className:`w-full border rounded px-3 py-2 ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"income",children:"Income"}),e.jsx("option",{value:"expense",children:"Expense"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-gray-300":"text-gray-700"}`,children:"Category"}),e.jsx("input",{type:"text",value:a.category,onChange:t=>s({...a,category:t.target.value}),className:`w-full border rounded px-3 py-2 ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"e.g., Salary, Rent",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-gray-300":"text-gray-700"}`,children:"Amount"}),e.jsx("input",{type:"number",step:"0.01",value:a.amount,onChange:t=>s({...a,amount:t.target.value}),className:`w-full border rounded px-3 py-2 ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-gray-300":"text-gray-700"}`,children:"Currency"}),e.jsx(S,{value:a.currency,onChange:t=>s({...a,currency:t}),className:"w-full"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-gray-300":"text-gray-700"}`,children:"Frequency"}),e.jsx("select",{value:a.frequency,onChange:t=>s({...a,frequency:t.target.value}),className:`w-full border rounded px-3 py-2 ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:y.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-gray-300":"text-gray-700"}`,children:"Description"}),e.jsx("textarea",{value:a.description,onChange:t=>s({...a,description:t.target.value}),className:`w-full border rounded px-3 py-2 ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,rows:"2",placeholder:"Optional description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-gray-300":"text-gray-700"}`,children:"Start Date"}),e.jsx("input",{type:"date",value:a.start_date,onChange:t=>s({...a,start_date:t.target.value}),className:`w-full border rounded px-3 py-2 ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-purple-500 hover:bg-purple-600 text-white py-2 rounded",children:"Create Recurring"}),e.jsx("button",{type:"button",onClick:()=>x(!1),className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded",children:"Cancel"})]})]})]})})]})},R=()=>e.jsx(C,{});export{R as default};
