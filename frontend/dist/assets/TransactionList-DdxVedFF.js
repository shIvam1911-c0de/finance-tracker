import{r,c as f,j as e,u as S}from"./index-DeXpUch5.js";const T=(n={})=>{const[u,d]=r.useState([]),[a,i]=r.useState(!1),[y,x]=r.useState(null),[l,m]=r.useState({page:1,limit:10,total:0,pages:0}),[g,p]=r.useState(n),o=r.useCallback(async()=>{i(!0),x(null);try{const t={page:l.page,limit:l.limit,...g},s=await f.get("/transactions",{params:t});d(s.data.transactions),m(c=>({...c,...s.data.pagination}))}catch(t){x(t.response?.data?.error||"Failed to fetch transactions")}finally{i(!1)}},[l.page,l.limit,g]);r.useEffect(()=>{o()},[o]);const b=r.useCallback(async t=>{try{const s=await f.post("/transactions",t);return d(c=>[s.data,...c]),{success:!0,data:s.data}}catch(s){return{success:!1,error:s.response?.data?.error||"Failed to create transaction"}}},[]),h=r.useCallback(async(t,s)=>{try{const c=await f.put(`/transactions/${t}`,s);return d(C=>C.map(N=>N.id===t?c.data:N)),{success:!0,data:c.data}}catch(c){return{success:!1,error:c.response?.data?.error||"Failed to update transaction"}}},[]),k=r.useCallback(async t=>{try{return await f.delete(`/transactions/${t}`),d(s=>s.filter(c=>c.id!==t)),{success:!0}}catch(s){return{success:!1,error:s.response?.data?.error||"Failed to delete transaction"}}},[]),j=r.useCallback(t=>{p(t),m(s=>({...s,page:1}))},[]),w=r.useCallback(t=>{m(s=>({...s,page:t}))},[]),v=r.useCallback(()=>{o()},[o]);return{transactions:u,loading:a,error:y,pagination:l,filters:g,createTransaction:b,updateTransaction:h,deleteTransaction:k,updateFilters:j,changePage:w,refresh:v}},D=["Food","Transport","Entertainment","Shopping","Bills","Healthcare","Education","Salary","Investment","Other"],F=({transaction:n,onSubmit:u,onCancel:d})=>{const[a,i]=r.useState({type:"expense",category:"",amount:"",description:"",date:new Date().toISOString().split("T")[0]}),[y,x]=r.useState(""),[l,m]=r.useState(!1);r.useEffect(()=>{n&&i({type:n.type,category:n.category,amount:n.amount,description:n.description||"",date:n.date.split("T")[0]})},[n]);const g=o=>{i({...a,[o.target.name]:o.target.value})},p=async o=>{if(o.preventDefault(),x(""),!a.category||!a.amount||!a.date){x("Please fill in all required fields");return}if(parseFloat(a.amount)<=0){x("Amount must be greater than 0");return}m(!0);const b=await u({...a,amount:parseFloat(a.amount)});b.success||(x(b.error),m(!1))};return e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:n?"Edit Transaction":"Add Transaction"}),y&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:y}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type *"}),e.jsxs("select",{name:"type",value:a.type,onChange:g,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[e.jsx("option",{value:"expense",children:"Expense"}),e.jsx("option",{value:"income",children:"Income"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category *"}),e.jsxs("select",{name:"category",value:a.category,onChange:g,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[e.jsx("option",{value:"",children:"Select category"}),D.map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Amount *"}),e.jsx("input",{type:"number",name:"amount",value:a.amount,onChange:g,required:!0,step:"0.01",min:"0.01",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date *"}),e.jsx("input",{type:"date",name:"date",value:a.date,onChange:g,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),e.jsx("textarea",{name:"description",value:a.description,onChange:g,rows:"3",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"Optional description"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:l,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Saving...":n?"Update":"Create"}),e.jsx("button",{type:"button",onClick:d,className:"flex-1 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-white py-2 px-4 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors",children:"Cancel"})]})]})]})},E=({filters:n,onFilterChange:u})=>{const[d,a]=r.useState(n),i=r.useCallback(l=>{a({...d,[l.target.name]:l.target.value})},[d]),y=r.useCallback(()=>{u(d)},[d,u]),x=r.useCallback(()=>{const l={type:"",category:"",search:"",startDate:"",endDate:""};a(l),u(l)},[u]);return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type"}),e.jsxs("select",{name:"type",value:d.type||"",onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"income",children:"Income"}),e.jsx("option",{value:"expense",children:"Expense"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Search"}),e.jsx("input",{type:"text",name:"search",value:d.search||"",onChange:i,placeholder:"Search...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:d.startDate||"",onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:d.endDate||"",onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]}),e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsx("button",{onClick:y,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Apply"}),e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-white rounded-lg hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors",children:"Reset"})]})]})]})},L=()=>{const{canModify:n}=S(),{transactions:u,loading:d,pagination:a,filters:i,updateFilters:y,changePage:x,createTransaction:l,updateTransaction:m,deleteTransaction:g,refresh:p}=T(),[o,b]=r.useState(!1),[h,k]=r.useState(null),j=r.useCallback(async t=>{const s=await l(t);return s.success&&(b(!1),p()),s},[l,p]),w=r.useCallback(async(t,s)=>{const c=await m(t,s);return c.success&&(k(null),p()),c},[m,p]),v=r.useCallback(async t=>{window.confirm("Are you sure you want to delete this transaction?")&&(await g(t),p())},[g,p]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Transactions"}),n()&&e.jsx("button",{onClick:()=>b(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"+ Add Transaction"})]}),e.jsx(E,{filters:i,onFilterChange:y}),(o||h)&&n()&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full",children:e.jsx(F,{transaction:h,onSubmit:h?t=>w(h.id,t):j,onCancel:()=>{b(!1),k(null)}})})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:d?e.jsx("div",{className:"p-8 text-center text-gray-600 dark:text-gray-400",children:"Loading transactions..."}):u.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-600 dark:text-gray-400",children:["No transactions found. ",n()&&"Add your first transaction!"]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Amount"}),n()&&e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:u.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:t.category})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 dark:text-white",children:t.description||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.type==="income"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:t.type})}),e.jsxs("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-medium ${t.type==="income"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[t.type==="income"?"+":"-","$",parseFloat(t.amount).toFixed(2)]}),n()&&e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>k(t),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:"Edit"}),e.jsx("button",{onClick:()=>v(t.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:"Delete"})]})]},t.id))})]})}),a.pages>1&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Showing page ",a.page," of ",a.pages," (",a.total," total)"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>x(a.page-1),disabled:a.page===1,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>x(a.page+1),disabled:a.page===a.pages,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})})]})};export{L as default};
